---
title: "CompMus project"
author: "Rachel van 't Hull"
date: "2/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(spotifyr)
library(ggrepel)
library(grid)
```

```{r}
pablo_honey <- get_playlist_audio_features("", "1S7Bn1zPkqKler2p1MmE2B")
the_bends <- get_playlist_audio_features("", "00aSCr8pdsbOQvmcj41q6z")
ok_computer <- get_playlist_audio_features("", "6yPwcbgFAUXfSsKD9LPnj8")
kid_a <- get_playlist_audio_features("", "0H7oSmnVe8kctcTbr6hYda")
amnesiac <- get_playlist_audio_features("", "7fuj13FdVe98ZPIo9BBWGj")
hail_to_the_thief <- get_playlist_audio_features("", "3GvfHR5ZF5OqeX5YdwCsIQ")
in_rainbows <- get_playlist_audio_features("", "7eV9P6cpSRyYKuLegRNbbe")
the_king_of_limbs <- get_playlist_audio_features("", "2701aFzj6VyyBuSXNo7DfD")
a_moon_shaped_pool <- get_playlist_audio_features("", "0hlGldKBhW9PosAEdFylRJ")
```

```{r}
radiohead <-
  bind_rows(
    pablo_honey %>% mutate(category = "Pablo Honey"),
    the_bends %>% mutate(category = "The Bends"),
    ok_computer %>% mutate(category = "OK Computer"),
    kid_a %>% mutate(category = "Kid A"),
    amnesiac %>% mutate(category = "Amnesiac"),
    hail_to_the_thief %>% mutate(category = "Hail To The Thief"),
    in_rainbows %>% mutate(category = "In Rainbows"),
    the_king_of_limbs %>% mutate(category = "The King Of Limbs"),
    a_moon_shaped_pool %>% mutate(category = "A Moon Shaped Pool")
  )
```

```{r}
level_order <- c("Pablo Honey", "The Bends", "OK Computer", "Kid A", "Amnesiac", "Hail To The Thief", "In Rainbows", "The King Of Limbs", "A Moon Shaped Pool")

test <- radiohead %>%
    group_by(playlist_name) %>%
    summarize(meanEnergy = mean(energy), meanValence = mean(valence), meanLoudness = mean((loudness-min(loudness))/(max(loudness)-min(loudness))), meanTempo = mean((tempo-min(tempo))/(max(tempo)-min(tempo))))

test2 <- radiohead %>%
    group_by(playlist_name) %>%
    summarize(meanEnergy = mean(energy), meanValence = mean(valence), meanLoudness = mean(loudness), meanTempo = mean(tempo))
```

## Introduction
Rachel van 't Hull - 12179299

The corpus I chose contains all 101 songs from Radiohead's 9 studio albums, that is "Pablo Honey", "The bends", "OK Computer", "Kid A", "Amnesiac", "Hail to the Thief", "In Rainbows", "The King of Limbs" and "A Moon Shaped Pool". While all of Radiohead's albums can be labeled as rock, the band has experimented with different sounds along the way, making each individual album to contain a distinct sound in terms of instruments, style and theme, which makes the corpus very fit for a computational musicological research.

Though each album carries a distinct feel, the songs within an album often range from quiet to grunge. For example, perhaps Radiohead's most famous song, "Creep", has a very different sound from the rest of grunge album "Pablo Honey". For "The Bends", whereas "Fake Plastic Trees" is a soft and calm song, "My Iron Lung" returns to hard-rock sounds. On the other hand, "Paranoid Android" is very typical for "OK Computer", containing the "sci-fi" sounds present throughout the album. Furthermore, while most albums are made in different phases of the band's style, the album "Amnesiac" in general has very similar sounds to "Kid A" as they were recorded during the same sessions.

The variation in both Radiohead's different albums as well as the individual songs within an album makes it interesting to not only analyze how Radiohead's style has evolved over time, but also see whether a computational model regards songs from different albums as similar. For both these questions, the factors contributing to the outcomes could be very interesting in describing Radiohead's different sounds within its discography in a computational, musicological manner.

## Plot 1
For the plot below, the loudness and tempo of the songs were normalized.
Valence and energy seem to follow almost exactly the same trend throughout the albums: af fall from *Pablo Honey* until *Amnesiac*, followed by a rise until *The King Of Limbs*, to fall again in *A Moon Shaped Pool*. loudness also follows this pattern from *Kid A* onwards, but at first rises from *Pablo Honey* until *Kid A*.

Tempo differs from the other trends the most. What is especially striking is that while the tempo falls from *Pablo Honey* until *Amnesiac*, the tempo rises. The opposite holds from the change between *Amnesiac* and *Hail To The Thief* and the change between *The King Of Limbs* and *A Moon Shaped Pool*.
Only from *Hail To The Thief* until *The King Of Limbs*, all 4 variables align.

```{r}
ggplot(test, aes(x=factor(playlist_name, level=level_order), group = 1)) + 
  geom_line(aes(y = meanValence, colour = "Valence", group=1)) + 
  geom_line(aes(y = meanEnergy, colour="Energy", group=2)) +
  geom_line(aes(y= meanLoudness, colour="Loudness", group=3)) +
  geom_line(aes(y= meanTempo, colour="Tempo", group=4)) +
  scale_colour_manual("", 
                      breaks = c("Valence", "Energy", "Loudness", "Tempo"),
                      values = c("red", "green", "steelblue", "purple"))+
  scale_y_continuous(         # Fine-tune the y axis in the same way.
    limits = c(0, 1)) +
  scale_x_discrete(guide = guide_axis(n.dodge=2)) +
  theme(axis.text.x = element_text(size = 7)) +
    labs(
    title = "Valence, Energy, Loudness and Tempo per Album",
    x = "Album",
    y = "Values"
  ) +
  theme(plot.title = element_text(hjust = 0.5))

```

## Plot 2
In the scatter plot below, the size of the points is the mean loudness (the bigger, the louder) and the intensity of the color is the tempo (the darker, the higher the tempo).

The saddest album appears to be the band's most recent album, *A Moon Shaped Pool*, clearly having both the lowest valence as well as the lowest energy, and also being the most quiet. *Pablo Honey*, the band's first album, seems to be one of the happiest albums, being the highest in valence and about average in energy.

Furthermore, *Hail To The Thief* and *In Rainbows* are almost exactly the same concerning valence, energy, with loudness only differing a tiny bit. *In Rainbows* being the album that followed up *Hail To The Thief* could be the explanation for this, however the albums are more than 4 years apart.

While most albums are some distance apart in the graph, the maximum and minimum values of valence and energy are only about 0.25 and 0.30 apart, respectively. To make more meaningful claims about the differences between individual albums, the songs in each album are to be taken into account.

```{r}
ggplot(test2, aes(x = meanEnergy, y = meanValence, size = meanLoudness, color = meanTempo)) +  
  geom_point(show.legend = F, alpha=0.8) +
    scale_size_continuous(      # Fine-tune the sizes of each point.
    trans = "exp",            # Use an exp transformation to emphasise loud.
    guide = "none"            # Remove the legend for size.
  ) +
  scale_color_continuous(      # Fine-tune the sizes of each point.
    trans = "exp"            # Use an exp transformation to emphasise loud.
  ) +
  scale_colour_gradient(low="#A9C8F3", high="#0C2389") +
  geom_text_repel(aes(label=playlist_name),  size=3, color="black") +
  scale_x_continuous(         # Fine-tune the y axis in the same way.
    limits = c(0.3, 0.7)
  ) +
  labs(
    title = "Mean Valence, Energy, Loudness and Tempo per Album",
    x = "Valence",
    y = "Energy"
  ) +
  theme(plot.title = element_text(hjust = 0.5))
  
```

## Plots 3 and 4
Most songs within an album are somewhat centered around one or two points of energy and valence (especially around low valence and medium energy), some more obvious than others. Exceptions are *Hail To The Thief* and *The King oF limbs*, where energy and valence differ most throughout each individual song.

```{r}
ggplot(radiohead, aes(x=playlist_name, y=valence, size=energy)) +
  geom_point(alpha=0.5) +
  geom_line(data=test2, aes(x=playlist_name, y=meanValence, size=0.1, colour="darkred",group=1),  show.legend = F) +
    scale_x_discrete(guide = guide_axis(n.dodge=2)) +
  theme(axis.text.x = element_text(size = 7)) +
  scale_size_continuous(      # Fine-tune the sizes of each point.
    trans = "exp",            # Use an exp transformation to emphasise loud.
    guide = "none"            # Remove the legend for size.
  ) +
  labs(
    title = "Valence and Energy per Album",
    x = "Album",
    y = "Valence"
  ) +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
radiohead %>%
  ggplot(
    aes(x = valence, 
        y = energy,
        size = loudness,
        color = tempo
    )
  ) +
  geom_point(alpha=0.8,  show.legend = F) +
    facet_wrap(~factor(playlist_name, level=level_order)) +     # Separate charts per playlist.
  scale_x_continuous(         # Fine-tune the x axis.
    limits = c(0, 0.85),
    breaks = c(0, 0.50, 1)   # Use grid-lines for quadrants only.
  ) +
  scale_y_continuous(         # Fine-tune the y axis in the same way.
    limits = c(0, 1.1),
    breaks = c(0, 0.50, 1)
  ) +
  scale_size_continuous(      # Fine-tune the sizes of each point.
    trans = "exp",            # Use an exp transformation to emphasise loud.
    guide = "none"            # Remove the legend for size.
  ) +
    labs(
    title = "Valence, Energy, Loudness and Tempo per Album",
    x = "Valence",
    y = "Energy"
  ) +
  theme(plot.title = element_text(hjust = 0.5)) +
 scale_colour_gradient(low="#A9C8F3", high="#0C2389")
```
